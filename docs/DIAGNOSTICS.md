# Диагностическая записка: Анализ системы обработки обращений

## А) Выделение смешанных ответственностей
В текущем компоненте `RequestProcessor` смешаны следующие ответственности:
1.  **Валидация входных данных**: Проверка на null и пустые строки.
2.  **Управление состоянием и доступ к данным**: Прямое создание `DatabaseClient` и выполнение SQL-запросов.
3.  **Журналирование**: Прямое создание `FileLogger` и запись в файл с жестко заданным путем.
4.  **Интеграция с внешними сервисами**: Прямое создание клиентов SMTP и Messenger API.
5.  **Бизнес-логика уведомлений**: Логика выбора канала связи (email/messenger) зашита внутри метода.
6.  **Формирование ответа**: Логика определения текста ответа на основе темы обращения.

## Б) Анализ связности и сцепления
Система обладает **высоким сцеплением (High Coupling)** и **низкой связностью (Low Cohesion)**:
*   **Жесткие зависимости**: Использование оператора `new` для создания клиентов БД, логгера и почтовых сервисов делает невозможным их подмену.
*   **Протекание инфраструктуры в домен**: Конкретные строки подключения к БД, пути к файлам логов (`c:/logs/app.log`) и токены API находятся прямо в коде бизнес-логики.
*   **Опасность**: Любое изменение в инфраструктуре (переезд на другую БД, смена провайдера уведомлений) требует изменения и перекомпиляции основного класса бизнес-логики.

## В) Диагностика тестируемости
Модульное тестирование метода `process` невозможно по следующим причинам:
1.  **Невозможность мокирования**: Зависимости создаются внутри метода через `new`, их нельзя подменить тестовыми дублерами.
2.  **Реальный ввод-вывод (I/O)**: Тест потребует наличия реальной базы данных и файловой системы.
3.  **Скрытые побочные эффекты**: Тест может попытаться отправить реальное письмо или сообщение в мессенджер.

## Г) Точки изменчивости
1.  **Каналы уведомлений**: Добавление новых способов связи (SMS, Push).
2.  **Хранилище данных**: Переход с SQL на NoSQL или внешнее API.
3.  **Правила маршрутизации**: Изменение логики формирования ответов в зависимости от темы.
4.  **Политика логирования**: Изменение формата логов или переход на централизованные системы (ELK, Graylog).
